<footer class="footer">
  <div class="footer__inner">

    {{- if .Site.Params.widgets.footer }}
    <div class="footer__widgets">
      {{- range .Site.Params.widgets.footer }}
        {{- partial (printf "widgets/%s.html" .) $ }}
      {{- end }}
    </div>
    {{- end }}

    {{/* Footer navigation (Access & Use, etc.) */}}
    {{ with .Site.Menus.footer }}
    <nav class="footer__nav" aria-label="Footer navigation">
      <ul class="footer__menu">
        {{ range . }}
        <li class="footer__menu-item">
          <a class="footer__menu-link" href="{{ .URL }}">
            {{ .Name }}
          </a>
        </li>
        {{ end }}
      </ul>
    </nav>
    {{ end }}

    <div class="footer__copyright">
      {{ .Site.Params.copyright | default (printf "Â© %d %s" now.Year .Site.Title) }}
    </div>

  </div>

  <!-- =========================
       DARK MODE TOGGLE SCRIPT
       ========================= -->

  <script>
    (function () {
      const root = document.documentElement;
      const toggle = document.getElementById('dark-mode-toggle');

      function applyTheme(theme) {
        if (theme === 'dark') {
          root.classList.add('dark-mode');
        } else {
          root.classList.remove('dark-mode');
        }
      }

      function getPreferredTheme() {
        const stored = localStorage.getItem('theme');
        if (stored) return stored;
        return window.matchMedia('(prefers-color-scheme: dark)').matches
          ? 'dark'
          : 'light';
      }

      const currentTheme = getPreferredTheme();
      applyTheme(currentTheme);

      if (toggle) {
        toggle.checked = currentTheme === 'dark';

        toggle.addEventListener('change', function () {
          const newTheme = toggle.checked ? 'dark' : 'light';
          localStorage.setItem('theme', newTheme);
          applyTheme(newTheme);
        });
      }
    })();
  </script>

</footer>